

=================================> AI에 질문 :


VB.NET 프로그램에서 아래 부분이 무한 반복이 되는데 소스 확인을 해서 오류나 무한반복의 원일을 파악해서 알려줘.

'''알람발송 이메일 목록
Dim ToList As String '받는사람
Dim CcList As String '참조
Dim FrMan As String '보내는 사람

```
    Dim ToIRow As Integer
    For ToIRow = 0 To g900.RowCount - 1

        If ToIRow >= g900.RowCount Then
            Exit For
        End If

        Dim Top As New OpenParameters
        Top.Add("@send_email", g900.Text("dl_proc_id", ToIRow))
        Dim TodSet As DataSet = OpenDataSet("cjsf013_s70", Top)

        If g900.Text("dl_status_cd", ToIRow) = "SF111000" Then
            FrMan = FrMan & DataValue(TodSet, "send_email") + ";"
        Else
            ToList = ToList & DataValue(TodSet, "send_email") + ";"
        End If

        ToIRow = ToIRow - 1
    Next

    Dim CcIRow As Integer
    For CcIRow = 0 To g910.RowCount - 1

        If CcIRow >= g910.RowCount Then
            Exit For
        End If

        Dim Ccp As New OpenParameters
        Ccp.Add("@send_email", g910.Text("dl_proc_id", CcIRow))
        Dim CcdSet As DataSet = OpenDataSet("cjsf013_s70", Ccp)

        CcList = CcList & DataValue(CcdSet, "send_email") + ";"

        CcIRow = CcIRow - 1
    Next
```



---===---===---===---===---===---> AI 답변 :




무한 반복의 원인은 아래 두 줄입니다:

```vb
    ToIRow = ToIRow - 1
```

그리고

```vb
    CcIRow = CcIRow - 1
```

VB.NET의 `For i = 0 To N − 1 … Next` 문은 `Next`에서 자동으로 `i = i + 1`을 합니다. 그런데 루프 안에서 다시 `i = i - 1`을 해 버리면 매 사이클마다

1. 시작할 때 `i = 0`
2. 루프 본문에서 `i = i - 1` → `i = -1`
3. `Next` 구문에서 `i = i + 1` → `i = 0`

이렇게 “0 → -1 → 0 → -1 → …” 무한 반복이 발생하게 됩니다.

---

### 해결 방법

1. **카운터를 직접 건드리지 않는다.**

   ```vb
   For ToIRow = 0 To g900.RowCount - 1
       Dim Top As New OpenParameters
       Top.Add("@send_email", g900.Text("dl_proc_id", ToIRow))
       Dim TodSet As DataSet = OpenDataSet("cjsf013_s70", Top)

       If g900.Text("dl_status_cd", ToIRow) = "SF111000" Then
           FrMan &= DataValue(TodSet, "send_email") & ";"
       Else
           ToList &= DataValue(TodSet, "send_email") & ";"
       End If
       ' → 여기에서 ToIRow = ToIRow - 1 제거!
   Next
   ```

2. **역순으로 처리하고 싶다면 `Step -1`을 쓴다.**

   ```vb
   For ToIRow = g900.RowCount - 1 To 0 Step -1
       ' … 중략 …
   Next
   ```

3. (선택) `If ToIRow >= g900.RowCount Then Exit For` 검사는 `For`문의 범위를 넘어설 일이 없으므로 지워도 됩니다.

4. (권장) `ToList`, `CcList`, `FrMan` 변수는 사용 전에 빈 문자열로 초기화해 두세요.

   ```vb
   Dim ToList As String = ""
   Dim CcList As String = ""
   Dim FrMan  As String = ""
   ```

이렇게 수정하면 인덱스가 의도대로 증가(또는 감소)하면서 루프가 정상 종료됩니다.





=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :









=================================> AI에 질문 :





---===---===---===---===---===---> AI 답변 :










