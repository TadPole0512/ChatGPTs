#Requires AutoHotkey v2.0
; #Include JSON.ahk  ; 사용하지 않으므로 주석 또는 삭제

; ===== 고정 텍스트 입력 =====
^!1:: {
    text := "너는 메타프롬프트나 RAG 같은 프롬프트 작성 규칙 등을 이용하여 프롬프트를 전문적으로 설계하는 프롬프트 엔지니어 전문가야.`n"
          . "네 임무는 아래의 프롬프트 초안을 가지고, 최적의 답변을 이끌어낼 수 있도록 정교하고 효과적인 프롬프트로 변환하는 거야.`n"
          . "현재 가장 많이 사용하거나 적합한 툴을 이용하는 방법을 최우선 고려해줘.`n"
          . "최신 프롬프트 엔지니어링 기법을 사용해서 내용을 구성해줘.`n"
          . "입력이 불완전할 경우,`n"
          . "- 치명적인 정보 부족 시에만 clarification 질문을 한다.`n"
          . "- 그 외는 스스로 합리적 가정 및 전제를 세우고, 답변 안에`n"
          . "  - “(가정: …)” 형태로 명시한다.`n"
          . "출력 결과는 복사·붙여넣기 하기 쉽게 코드 블록 안에 형식화해서 제시해줘.`n`n"
          . "## 프롬프트 초안 :`n"
    InsertText(text)
}

^!2:: {
    text := "추가 :`n"
          . "- 작업단계 계획 제시`n"
          . "- 더 깊게 생각하고, 작업 흐름에 따라 단계별로 정리`n"
          . "- 최신자료(" FormatTime(, "yyyy") "년)를 최우선으로 정리`n"
          . "- 자료 검색할 때는 최신 자료를 기준으로 한글, 영문, 중문, 일본어 등 외국어 포함해서 조사하고 한글로 출력하게 해주고, 인용 시 출처를 남기게 해줘.`n"
          . "- 추정 내용일 때는 추정이라고 명시`n"
          . "- 인용한 자료 출처 명시`n"
          . "- 장황한 설명 위주의 답변이 아니라 이미지 중심의 이미지가 가득한 설명이 곁들여지는 답변을 받고 싶어.`n"
          . "- 출력 결과를 작성할 때는 이미지(텍스트 이미지 포함)를 50%이상 사용할 수 있도록 해줘`n"
          . "- 화면 출력 전에 3번 이상 검증작업을 한 다음 내용을 제공`n`n"
          . "우선 답변하기 전에, 네 답변이 최고 수준에 도달하기 위한 내부적인 기준을 먼저 세워줘.`n"
          . "그리고 그 기준으로 만점을 받을 때 까지 내부적으로 결과물을 다듬은 뒤에, 나에게는 최종적으로 완성된 완벽한 출력만 보여줘.`n"
    InsertText(text)
}

^!3:: {
	; [설정] 딜레이가 작동하도록 모드를 'Event'로 변경 (기본 Input 모드는 딜레이 무시함)
	SendMode "Event"
	SetKeyDelay 50, 50  ; 누르기 전 지연 50ms, 누른 상태 유지 50ms (한 번만 설정하면 됨)

	; [실행]
	Send "hsg"
	Send "{Tab}"

	; 중요: 특수문자(#, !, ^, +)가 포함된 텍스트는 SendText를 쓰는 것이 안전합니다.
	; (그냥 Send를 쓰면 #을 윈도우 키로 인식해버릴 수 있음)
	SendText "CheolWone3E#" 

	Send "{Tab}"
	Send "{Enter}"
}

^!4:: {
    text := "`n`n`n`n`n`n`n`n`n"
    InsertText(text)
}

^!5:: {
    InsertText("sbmdemo1234!")
}

^!6:: {
    InsertText("emax1234!")
}

^!7:: {
    InsertText("`n`n`n`n`n`n`n`n`n")
}

; ===== 날짜 입력 =====
^!8:: {
    Send(FormatTime(, "yyyyMMdd"))
}

^!9:: {
    Send(FormatTime(, "yyyy-MM-dd"))
}

;^!0:: {
;    InsertText(FormatTime(, "yyyy-MM-dd") " hsg ")
;}

; ===== 구분선/주석 =====
^!-:: {
    Send("---------------------------------------------------------------------`n")
}
; ===== 템플릿 =====
^!]:: {
    text := "안녕하세요. 서린정보기술 홍성근입니다.`n`n"
           . "요청하신 아래 내용을 테스트 서버에 반영했습니다.`n`n`n`n"
           . "작업은 고승주 수석님께서 하셨습니다.`n`n"
           . "확인 부탁드립니다.`n`n"
           . "감사합니다."
    InsertText(text)
}

; ===== 공통 함수 =====
InsertText(text) {
    static originalClip := ""
    
    try {
        originalClip := ClipboardAll()
        A_Clipboard := text
        
        if ClipWait(1) {
            Send("^v")
            Sleep(100)
        }
    } finally {
        if IsSet(originalClip)
            A_Clipboard := originalClip
    }
}